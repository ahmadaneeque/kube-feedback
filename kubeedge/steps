
ps -p 1 -o comm=

az aks get-credentials --resource-group SSAICloudMigration --name kubeedge

az vmss list-instance-public-ips -g MC_SSAICloudMigration_seldonDemo_westus2 -n aks-agentpool-22931508-vmss


az aks create -g SSAICloudMigration -n kubeedge --kubernetes-version 1.21.14 --enable-node-public-ip

az aks nodepool add -g SSAICloudMigration --cluster-name kubeedge -n nodepool2 --enable-node-public-ip


https://dev.to/s1ntaxe770r/how-to-setup-ssh-within-a-docker-container-i5i

https://medium.com/@gaponcic.d/getting-started-with-kubeedge-on-virtual-machines-8cfa2b314b11

https://gokulchandrapr.medium.com/kubeedge-extending-kubernetes-to-edge-dcfedd91f5f9

docker build edgenode .

docker run --network=kind -v /var/run/docker.sock:/var/run/docker.sock -ti edgenode

docker run --privileged -d --network=kind -v /var/run/docker.sock:/var/run/docker.sock --name=edgenode edgenode

docker run --rm kubeedge/installation-package:v1.12.0 cat /usr/local/bin/keadm > /usr/local/bin/keadm && chmod +x /usr/local/bin/keadm

curl -LO https://storage.googleapis.com/minikube/releases/v1.22.1/minikube-linux-amd64
curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl

az aks show --resource-group SSAICloudMigration --name kubeedge --query nodeResourceGroup -o tsv

az network public-ip create \
    --resource-group SSAICloudMigration \
    --name kube-cloud \
    --sku Standard \
    --allocation-method static


TOKEN=$(sudo keadm gettoken --kube-config=/home/ahmad/.kube/config)

copy to edge

# keadm init --advertise-address="THE-EXPOSED-IP"(only work since 1.3 release)

ssh test@172.18.0.2

cat TOKEN > token.txt

TOKEN=$(cat token.txt)


docker exec edgenode service ssh start

docker exec edgenode 


docker kill edgenode

docker run --rm kubeedge/installation-package:v1.12.0 cat /usr/local/bin/keadm > /usr/local/bin/keadm && chmod +x /usr/local/bin/keadm
sudo keadm init --kube-config=/home/cloud/.kube/config --advertise-address=20.0.194.174

helm upgrade --install cloudcore ./cloudcore --namespace kubeedge --create-namespace -f ./cloudcore/values.yaml --set cloudCore.modules.cloudHub.advertiseAddress[0]=20.0.250.167

helm upgrade --install cloudcore . --namespace kubeedge --create-namespace

kubectl create ns kubeedge


helm upgrade --install cloudcore . --namespace kubeedge --create-namespace 

sudo keadm init --kube-config=/home/ahmad/.kube/config --advertise-address=20.49.242.8

helm uninstall cloudcore -n kubeedge

kubectl get secret -n kubeedge tokensecret -o=jsonpath='{.data.tokendata}' | base64 -d

sudo keadm gettoken --kube-config=/home/ahmad/.kube/config


sudo keadm join --cloudcore-ipport=20.204.211.199:10000 --token=$TOKEN

sudo keadm join  --cloudcore-ipport=51.142.99.211:10000 --token=aec80e98d8bc3505f0e21bef5f3a0c3f5c8fcca710ebb4ec1654c09e35a22abf.eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NzI5MTY0NjZ9.QYKWzECGK4RQGpq7VWulWbQvqyJgOeC2NmpHO4ZnRIk --kubeedge-version=v1.12.0



kubectl get cm tunnelport -n kubeedge -o yaml


iptables -t nat -A OUTPUT -p tcp --dport 10350 -j DNAT --to 172.18.0.2:10003
iptables -t nat -A OUTPUT -p tcp --dport 10352 -j DNAT --to 10.224.0.4:10003
iptables -t nat -A OUTPUT -p tcp --dport 10351 -j DNAT --to 10.224.0.6:10003


kubectl -n kubeedge rollout restart deployment cloudcore


systemctl restart edgecore.service



